"use strict";(()=>{var e={};e.id=204,e.ids=[204],e.modules={1018:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{default:()=>u});var a=r(1428),s=r(8152),o=r(6846),i=e([a,o]);async function u(e,t){if("POST"!==e.method)return t.status(405).json({error:"Method not allowed"});if(!(0,s.wR)(e))return t.status(401).json({error:"Unauthorized"});let{symbol:r}=e.query;if(!r||"string"!=typeof r)return t.status(400).json({error:"Invalid symbol"});let n=`spread_analysis:${r.toUpperCase()}`;try{let e=await (0,o.hi)(n);if(e)return t.status(200).json(e);let s=await a.default.post("https://income-machine-20-bulk-spread-check-1-daiadigitalco.replit.app/api/analyze_debit_spread",{ticker:r.toUpperCase()},{timeout:3e4,headers:{"Content-Type":"application/json"}});if(200!==s.status||!s.data.success)return t.status(500).json({error:"Failed to analyze spreads",details:s.data});{let e=s.data;return await (0,o.H$)(n,e,180),t.status(200).json(e)}}catch(e){if(console.error("Spread analysis error:",e),a.default.isAxiosError(e)){if("ECONNABORTED"===e.code)return t.status(408).json({error:"Request timeout"});if(e.response)return t.status(e.response.status).json({error:"External API error",details:e.response.data})}return t.status(500).json({error:"Internal server error"})}}[a,o]=i.then?(await i)():i,n()}catch(e){n(e)}})},1428:e=>{e.exports=import("axios")},3480:(e,t,r)=>{e.exports=r(5600)},3564:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{config:()=>d,default:()=>l,routeModule:()=>c});var a=r(3480),s=r(8667),o=r(6435),i=r(1018),u=e([i]);i=(u.then?(await u)():u)[0];let l=(0,o.M)(i,"default"),d=(0,o.M)(i,"config"),c=new a.PagesAPIRouteModule({definition:{kind:s.A.PAGES_API,page:"/api/analyze/[symbol]",pathname:"/api/analyze/[symbol]",bundlePath:"",filename:""},userland:i});n()}catch(e){n(e)}})},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6435:(e,t)=>{Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},6436:e=>{e.exports=import("@upstash/redis")},6846:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.d(t,{H$:()=>u,hi:()=>i});var a=r(6436),s=e([a]);a=(s.then?(await s)():s)[0];let l=null;function o(){return l||(l=new a.Redis({url:process.env.UPSTASH_REDIS_REST_URL,token:process.env.UPSTASH_REDIS_REST_TOKEN})),l}async function i(e){try{let t=o();return await t.get(e)}catch(t){return console.error(`Redis GET error for key ${e}:`,t),null}}async function u(e,t,r=180){try{let n=o();await n.setex(e,r,JSON.stringify(t))}catch(t){console.error(`Redis SET error for key ${e}:`,t)}}n()}catch(e){n(e)}})},8152:(e,t,r)=>{r.d(t,{wR:()=>o});let n=require("jsonwebtoken");var a=r.n(n);let s=`-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4f5wg5l2hKsTeNem/V41
fGnJm6gOdrj8ym3rFkEjWT2btf06kkstX0BdVqKyGJm7TQsLt3nLDj9dxKwNsU0f
Vp4H3VHZrQNxVOgB2wG6dRkj7w+7QbqMTBJfEVUhkE9g0fOhp9Xg4GdO8g7N1qPb
f8n0WzGLWVFT5XPTfp5PaO3F6Q8Z5g5v1p4A2O4F8DQ8+P6K+N9w6zKtW5f6qW8x
f+bT7I7KqGbTr2XM7A3t0vOj5VRe8VQ7kK7Af6z8hD2L9Rg6K5z8X7g0+hWJn5zE
YOJr7qFzO5zRoE8TI6L8c4aZ6Eq2G6yKo8Y5J7cxW1yV+Q+p9zKJ9nK7p1Q2ov5X
QIDAQAB
-----END PUBLIC KEY-----`;function o(e){let t=function(e){let t=e.headers.authorization;return t&&t.startsWith("Bearer ")?t.substring(7):null}(e);if(!t)return null;try{return a().verify(t,s,{algorithms:["RS256"],issuer:void 0,audience:void 0})}catch(e){return console.error("JWT validation failed:",e),null}}},8667:(e,t)=>{Object.defineProperty(t,"A",{enumerable:!0,get:function(){return r}});var r=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=t(t.s=3564);module.exports=r})();